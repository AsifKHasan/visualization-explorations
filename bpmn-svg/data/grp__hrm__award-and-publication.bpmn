/*
# this is bpmn DSL, it starts with keyword bpmn (case matters in our DSL) and an identifier for the graph
# this is pretty much close to GraphViz's dot language
# _ is a special keyword for specifying properties for the scope and its children, scopes are nested like graph --> lane --> pool --> task cells etc.
# properties are always inside [] and are key value pairs
# TODO: this .bpmn can be generated with the following command line
# TODO: node generate_bpmn.js [-s path-to-styleheet.css] [-r html|svg|png] [-o path-to-output.[html|svg|png]] path-to-input.bpmn

Lanes are A-Z, Pools are 1-9 within a lane, Nodes are a-z within a pool

1. to parse the bpmn only, run
    python bpmn-parser.py < ../data/grp__hrm__award-and-publication.bpmn > ../out/grp__hrm__award-and-publication.json
    it will generate json output at ../out/grp__hrm__award-and-publication.json

2. to parse the bpmn and generate the svg, run
    python bpmn-parser.py < ../data/grp__hrm__award-and-publication.bpmn | tee ../out/grp__hrm__award-and-publication.json | python bpmn-to-svg.py
    it will generate svg output at ../out/grp__hrm__award-and-publication.svg

3. to generate svg from an existing parsed json (generated by bpmn-parser.py), run
    python bpmn-to-svg.py < ../out/grp__hrm__award-and-publication.json
    it will generate svg output at ../out/grp__hrm__award-and-publication.svg

Note:   This template will produce parse error unless you change the node types (like A1a, B2c etc.) to a valid one.
        For valid node types see *NodeType* definitions in *tokenize* method *specs* in bpmn-parser.py

Note:   For valid edge syntax see *EdgeOp* definitions in *tokenize* method *specs* in bpmn-parser.py
*/

graph award_publication {
    label = "Award and Publication Management"

    lane ictd {
        label = "ICT Division"

        pool employee {
            label = "Global Admin"

            start start1 [label="New award/publication";]
            task upload_form [label="Upload award publication information form";]
            task send_to_authority [label="Send request to authority";]
            task modify [label="Create User Procurement Entity 1";]

            start1 ..> upload_form
        }
        pool authority {
            label = "Authority"

            task receive_request [label="Receive request";]
            task verify_request [label="Verify employee request";]
            exclusive request_approval
            task send_back_for_modification [label="Send back form for modification";]

            receive_request ..> verify_request ..> request_approval
            request_approval ..> send_back_for_modification [label="No";]
        }
        pool system {
            label = "System"

            task notify_employee [label="Notify employee";]
            task update_employee_details [label="Update employee details";]
            task set_view_status [label="Set view status of the award(s)/publication(s)";]
            end end1 [label="Completed";]

            notify_employee ..> update_employee_details ..> set_view_status ..> end1
        }
    }
    lane mopa {
        label = "Ministry of Public Administration (MoPA)"

        pool pmis {
            label = "Personnel Management Information System (PMIS)"

            process employee_details [label="Employee Details - who is the employee";]
        }
    }
}
